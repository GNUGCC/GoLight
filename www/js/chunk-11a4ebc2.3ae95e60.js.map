{"version":3,"sources":["webpack:///./src/views/Family.vue?edfe","webpack:///./src/views/Family.vue","webpack:///./src/views/Family.vue?8f51"],"names":["ref","style","slot","default-href","class","size","isRemote","src","imgUrl","alt","accept","imgFileChange","type","name","interface","calendar_type","value","displayFormat","birthday","save","components","IonBackButton","IonButton","IonButtons","IonCol","IonContent","IonDatetime","IonFooter","IonGrid","IonHeader","IonInput","IonItem","IonLabel","IonPage","IonRow","IonSelect","IonSelectOption","IonTitle","IonToolbar","MenuBar","id","this","$route","params","image","croppieIns","methods","result","family","imgData","split","$router","go","e","file","target","files","reader","FileReader","readAsDataURL","onload","query","watch","to","indexOf","$refs","imgEditor","destroy","c","viewport","width","height","boundary","bind","url","__exports__","render"],"mappings":"gHAAA,W,2GCOmB,U,GAOiBA,IAAI,a,GACvBC,MAAA,6C,iBAQQ,Y,iBAMA,Y,iBAMA,U,iBAEoB,M,iBACA,M,iBAMpB,Y,iBAK8B,M,+pBAhDrD,eAwDW,Q,uBAvDT,IAOa,CAPb,eAOa,Q,uBANX,IAKc,CALd,eAKc,Q,uBAJZ,IAEc,CAFd,eAEc,GAFDC,KAAK,SAAO,C,uBACvB,IAA+D,CAA/D,eAA+D,GAA9CC,eAAa,mB,MAEhC,eAA6B,Q,uBAAlB,IAAM,C,0BAGrB,eA2Cc,GA3CDC,MAAM,eAAa,C,uBAC9B,IAyCW,CAzCX,eAyCW,Q,uBAxCT,IAOU,CAPV,eAOU,GAPDH,MAAA,8BAA+B,C,uBACtC,IAKU,CALV,eAKU,GALDI,KAAK,MAAI,C,uBAChB,IAA8C,C,eAA9C,eAA8C,MAA9C,EAA8C,W,SAAhC,EAAAC,YACd,eAEM,MAFN,EAEM,C,eADJ,eAA2F,GAAlFL,MAAA,+BAAsDM,IAAK,EAAAC,OAAQC,IAAI,W,yBAA5B,EAAAH,gB,cAI1D,eA+BU,Q,uBA9BR,IAKU,CALV,eAKU,GALDD,KAAK,MAAI,C,uBAChB,IAGW,CAHX,eAGW,GAHDD,MAAM,SAAO,C,uBACrB,IAA+B,CAA/B,eAA+B,Q,uBAApB,IAAQ,C,UACnB,eAA4E,GAAjEM,OAAO,UAAW,SAAQ,EAAAC,cAAeC,KAAK,Q,qCAG7D,eAKU,GALDP,KAAK,MAAI,C,uBAChB,IAGW,CAHX,eAGW,GAHDD,MAAM,SAAO,C,uBACrB,IAA+B,CAA/B,eAA+B,Q,uBAApB,IAAQ,C,UACnB,eAA2C,G,WAAlB,EAAAS,K,qCAAA,EAAAA,KAAI,G,eAAlB,W,uCAGf,eAQU,GARDR,KAAK,MAAI,C,uBAChB,IAMW,CANX,eAMW,GANDD,MAAM,gBAAc,C,uBAC5B,IAA6B,CAA7B,eAA6B,Q,uBAAlB,IAAM,C,UACjB,eAGa,GAHDU,UAAU,U,WAAmB,EAAAC,c,qCAAA,EAAAA,cAAa,I,wBACpD,IAAmD,CAAnD,eAAmD,GAAhCC,MAAM,KAAG,C,uBAAC,IAAE,C,UAC/B,eAAmD,GAAhCA,MAAM,KAAG,C,uBAAC,IAAE,C,mDAIrC,eAKU,GALDX,KAAK,MAAI,C,uBAChB,IAGW,CAHX,eAGW,GAHDD,MAAM,gBAAc,C,uBAC5B,IAA+B,CAA/B,eAA+B,Q,uBAApB,IAAQ,C,UACnB,eAA2E,GAA7Da,cAAc,a,WAAsB,EAAAC,S,qCAAA,EAAAA,SAAQ,I,uCAG9D,eAEU,GAFDb,KAAK,MAAI,C,uBAChB,IAA0D,CAA1D,eAA0D,GAA9CD,MAAM,WAAY,QAAO,EAAAe,M,wBAAM,IAAE,C,wDAKrD,eAEa,Q,uBADX,IAAqB,CAArB,eAAqB,K,2EAqCZ,GACbC,WAAY,CACVC,cAAA,mBACAC,UAAA,eACAC,WAAA,gBACAC,OAAA,YACAC,WAAA,gBACAC,YAAA,iBACAC,UAAA,eACAC,QAAA,aACAC,UAAA,eACAC,SAAA,cACAC,QAAA,aACAC,SAAA,cACAC,QAAA,aACAC,OAAA,YACAC,UAAA,eACAC,gBAAA,qBACAC,SAAA,cACAC,WAAA,gBACAC,UAAA,MAEF,OACE,MAAO,CACLC,GAAIC,KAAKC,OAAOC,OAAOH,GACvB3B,KAAM,GACNE,cAAe,GACfG,SAAU,GACV0B,MAAO,GACPpC,OAAQ,GACRqC,WAAY,KACZvC,UAAU,IAGdwC,QAAS,CACP,QACE,yBAAYL,KAAKD,GAAKO,IACpB,IAAIC,EAASD,EAAOC,OACpBP,KAAK5B,KAAOmC,EAAOnC,KACnB4B,KAAK1B,cAAiB,GAAEiC,EAAOjC,cAC/B0B,KAAKvB,SAAW8B,EAAO9B,SACvBuB,KAAKG,MAAQI,EAAOJ,SAGxB,aACE,IAAIK,EAAU,KAEZA,EADqB,OAApBR,KAAKI,WACIJ,KAAKnC,SAAWmC,KAAKG,YAAcH,KAAKI,WAAWE,OAAO,UAE1DN,KAAKG,MAEjB,wBAAW,CACTJ,GAAIC,KAAKD,GACT3B,KAAM4B,KAAK5B,KACXE,cAAe0B,KAAK1B,cACpBG,SAAUuB,KAAKvB,SAASgC,MAAM,KAAK,GACnCN,MAAOK,GACN,KACDR,KAAKU,QAAQC,IAAI,MAGrB,cAAcC,GACZ,MAAMC,EAAOD,EAAEE,OAAOC,MAAM,GACtBC,EAAS,IAAIC,WACnBD,EAAOE,cAAcL,GACrBG,EAAOG,OAAS,KACdnB,KAAKG,MAAQa,EAAOV,UAI1B,UACEN,KAAKoB,SAEPC,MAAO,CACL,OAAOC,GACW,WAAZA,EAAGlD,OACL4B,KAAKD,GAAKuB,EAAGpB,OAAOH,GACpBC,KAAKoB,UAGT,QACEpB,KAAKjC,OAAS,uBAAUiC,KAAKG,OAC7BH,KAAKnC,UAA8C,IAAnCmC,KAAKjC,OAAOwD,QAAQ,WAEtC,SACE,GAAGvB,KAAKnC,SAAU,OAClB,IAAImC,KAAKwB,MAAMC,UAAW,OACH,OAApBzB,KAAKI,aACNJ,KAAKI,WAAWsB,UAChB1B,KAAKI,WAAa,MAEpB,MAAMuB,EAAI,IAAI,IAAQ3B,KAAKwB,MAAMC,UAAW,CAC1CG,SAAU,CAAEC,MAAO,IAAKC,OAAQ,IAAK3D,KAAM,UAC3C4D,SAAU,CAAEF,MAAO,IAAKC,OAAQ,OAElCH,EAAEK,KAAK,CACLC,IAAKjC,KAAKjC,SAEZiC,KAAKI,WAAauB,K,iCCvLxB,MAAMO,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-11a4ebc2.3ae95e60.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Family.vue?vue&type=style&index=0&id=c12dcf18&scoped=true&lang=css\"","<template>\n  <ion-page>\n    <ion-header>\n      <ion-toolbar>\n        <ion-buttons slot=\"start\">\n          <ion-back-button default-href=\"/family-list\"></ion-back-button>\n        </ion-buttons>\n        <ion-title>編輯寵物資料</ion-title>\n      </ion-toolbar>\n    </ion-header>\n    <ion-content class=\"family-list\">\n      <ion-grid>\n        <ion-row style=\"justify-content: center\">\n          <ion-col size=\"12\">\n            <div v-show=\"!isRemote\" ref=\"imgEditor\"></div>\n            <div style=\"display: flex;justify-content: center;\">\n              <ion-img style=\"width: 150px;height: 150px\" v-show=\"isRemote\" :src=\"imgUrl\" alt=\"未上傳寵物圖片\"/>\n            </div>\n          </ion-col>\n        </ion-row>\n        <ion-row>\n          <ion-col size=\"12\">\n            <ion-item class=\"input\">\n              <ion-label>　　寵物圖片　　</ion-label>\n              <ion-input accept=\"image/*\" @change=\"imgFileChange\" type=\"file\"></ion-input>\n            </ion-item>\n          </ion-col>\n          <ion-col size=\"12\">\n            <ion-item class=\"input\">\n              <ion-label>　　寵物名稱　　</ion-label>\n              <ion-input v-model.trim=\"name\"></ion-input>\n            </ion-item>\n          </ion-col>\n          <ion-col size=\"12\">\n            <ion-item class=\"input select\">\n              <ion-label>　　曆別　　</ion-label>\n              <ion-select interface=\"popover\" v-model=\"calendar_type\">\n                <ion-select-option value=\"1\">國曆</ion-select-option>\n                <ion-select-option value=\"2\">農曆</ion-select-option>\n              </ion-select>\n            </ion-item>\n          </ion-col>\n          <ion-col size=\"12\">\n            <ion-item class=\"input select\">\n              <ion-label>　　寵物生日　　</ion-label>\n              <ion-datetime displayFormat=\"YYYY-MM-DD\" v-model=\"birthday\"></ion-datetime>\n            </ion-item>\n          </ion-col>\n          <ion-col size=\"12\">\n            <ion-button class=\"button-3\" @click=\"save\">儲存</ion-button>\n          </ion-col>\n        </ion-row>\n      </ion-grid>\n    </ion-content>\n    <ion-footer>\n      <menu-bar></menu-bar>\n    </ion-footer>\n  </ion-page>\n</template>\n\n<script>\nimport {\n  queryFamily,\n  saveFamily,\n  getImgSrc,\n} from \"../api\";\n\nimport Croppie from 'croppie';\n\nimport {\n  IonBackButton,\n  IonButton,\n  IonButtons,\n  IonCol,\n  IonContent,\n  IonDatetime,\n  IonFooter,\n  IonGrid,\n  IonHeader,\n  IonInput,\n  IonItem,\n  IonLabel,\n  IonPage,\n  IonRow,\n  IonSelect,\n  IonSelectOption,\n  IonTitle,\n  IonToolbar\n} from \"@ionic/vue\";\n\nimport MenuBar from \"@/views/MenuBar.vue\";\n\nexport default {\n  components: {\n    IonBackButton,\n    IonButton,\n    IonButtons,\n    IonCol,\n    IonContent,\n    IonDatetime,\n    IonFooter,\n    IonGrid,\n    IonHeader,\n    IonInput,\n    IonItem,\n    IonLabel,\n    IonPage,\n    IonRow,\n    IonSelect,\n    IonSelectOption,\n    IonTitle,\n    IonToolbar,\n    MenuBar\n  },\n  data() {\n    return {\n      id: this.$route.params.id,\n      name: \"\",\n      calendar_type: \"\",\n      birthday: \"\",\n      image: '',\n      imgUrl: '',\n      croppieIns: null,\n      isRemote: true,\n    };\n  },\n  methods: {\n    query() {\n      queryFamily(this.id, (result) => {\n        let family = result.family;\n        this.name = family.name;\n        this.calendar_type = `${family.calendar_type}`;\n        this.birthday = family.birthday;\n        this.image = family.image;\n      });\n    },\n    async save() {\n      let imgData = null\n      if(this.croppieIns !== null) {\n        imgData = this.isRemote ? this.image : await this.croppieIns.result('base64')\n      } else {\n        imgData = this.image\n      }\n      saveFamily({\n        id: this.id,\n        name: this.name,\n        calendar_type: this.calendar_type,\n        birthday: this.birthday.split(\"T\")[0],\n        image: imgData,\n      }, () => {\n        this.$router.go(-1);\n      });\n    },\n    imgFileChange(e) {\n      const file = e.target.files[0];\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        this.image = reader.result;\n      };\n    },\n  },\n  mounted() {\n    this.query();\n  },\n  watch: {\n    $route(to) {\n      if (to.name === \"Family\") {\n        this.id = to.params.id;\n        this.query();\n      }\n    },\n    image() {\n      this.imgUrl = getImgSrc(this.image)\n      this.isRemote = this.imgUrl.indexOf('base64') === -1\n    },\n    imgUrl() {\n      if(this.isRemote) return\n      if(!this.$refs.imgEditor) return\n      if(this.croppieIns !== null) {\n        this.croppieIns.destroy()\n        this.croppieIns = null\n      }\n      const c = new Croppie(this.$refs.imgEditor, {\n        viewport: { width: 150, height: 150, type: 'circle' },\n        boundary: { width: 300, height: 300 },\n      })\n      c.bind({\n        url: this.imgUrl\n      })\n      this.croppieIns = c\n    }\n  },\n};\n</script>\n\n<style scoped>\nion-grid {\n  margin: 20px 20px 0 20px;\n}\n</style>\n","import { render } from \"./Family.vue?vue&type=template&id=c12dcf18&scoped=true\"\nimport script from \"./Family.vue?vue&type=script&lang=js\"\nexport * from \"./Family.vue?vue&type=script&lang=js\"\n\nimport \"./Family.vue?vue&type=style&index=0&id=c12dcf18&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\mark\\\\Downloads\\\\mazulight-code\\\\mazulight-app\\\\mazulight-app-master\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-c12dcf18\"]])\n\nexport default __exports__"],"sourceRoot":""}